# PSM-R
Propensity Score Matching (PSM) for Coliform Levels and Population Growth in R
# Summary
This repository demonstrates how to apply Propensity Score Matching (PSM) to analyze the causal effect of population growth on coliform levels at various monitoring stations. The dataset contains time series data from eight stations, and the analysis aims to determine whether population growth has a significant impact on coliform concentrations.
# Steps
Data Preprocessing: Handling missing values, normalizing coliform data, and creating a treatment indicator based on population growth thresholds.
Propensity Score Calculation: Using logistic regression to estimate propensity scores, which represent the likelihood of high population growth given the coliform levels.
Matching: Matching observations from high population growth periods (treatment group) with those from low or no population growth periods (control group) based on their propensity scores.
ATT Calculation: Calculating the Average Treatment Effect on the Treated (ATT) to measure the impact of population growth on coliform concentrations.
Visualization: Plotting the ATT results to visualize the effect across multiple stations.

# Repository Structure
data/: Contains the raw coliform and population data.
scripts/: R scripts for data preprocessing, PSM, and visualization.
output/: Contains the matched data and visualizations generated by the analysis.
# Requirements
Ensure the following R packages are installed:
MatchIt: For Propensity Score Matching
dplyr: For data manipulation
ggplot2: For visualization
You can install these packages in R using:
install.packages(c("MatchIt", "dplyr", "ggplot2"))
My Workflow
# Data Preprocessing
The coliform time series data is preprocessed by:
Handling missing values using linear interpolation to maintain a continuous time series.
Normalizing coliform levels using the MinMaxScaler to scale data between 0 and 1.
Creating a treatment indicator for high population growth based on the 75th percentile of population growth.
# Propensity Score Calculation
Logistic regression is used to estimate the propensity scores:
psm_model <- matchit(Treatment ~ Q + G + J + N + P + B + D + E, 
                     data = data, 
                     method = "nearest", 
                     distance = "logit")
Where Treatment represents high population growth (top 25% of growth rates), and Q, G, J, N, P, B, D, E represent coliform levels at different stations.
# Matching and ATT Calculation
Matched data is extracted, and the Average Treatment Effect on the Treated (ATT) is calculated to measure the impact of population growth on coliform levels:
matched_data <- match.data(psm_model)
# Calculate ATT for coliform levels across stations
treatment_group <- matched_data %>% filter(Treatment == 1)
control_group <- matched_data %>% filter(Treatment == 0)
mean_treatment <- treatment_group %>% summarise(across(c(Q, G, J, N, P, B, D, E), mean))
mean_control <- control_group %>% summarise(across(c(Q, G, J, N, P, B, D, E), mean))
ATT <- mean_treatment - mean_control
# Visualization
Visualize the ATT for each station using ggplot2:
ggplot(data = data.frame(Station = stations, ATT = att_values), aes(x = Station, y = ATT)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  theme_minimal() +
  labs(y = "ATT (Coliform Concentration Difference)", x = "Station")
# Interpretation
The analysis shows which stations are most impacted by population growth, based on the calculated ATT values. Positive ATT values indicate an increase in coliform levels due to high population growth, while negative or zero values suggest minimal or no effect.

# Results
Station J and Q exhibited significant increases in coliform concentrations during periods of high population growth.
Station P showed a slight decrease in coliform levels, potentially indicating better management or environmental conditions in this area.
